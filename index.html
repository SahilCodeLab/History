<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>College Verification</title>
<style>
body { font-family:'Segoe UI',sans-serif; background:linear-gradient(135deg,#f6d365,#fda085); display:flex; justify-content:center; align-items:center; height:100vh; margin:0; }
.container { background:white; padding:30px 40px; border-radius:15px; box-shadow:0 10px 25px rgba(0,0,0,0.2); width:350px; text-align:center; }
h2 { margin-bottom:20px; color:#333; }
input { width:100%; padding:10px; margin:10px 0; border-radius:8px; border:1px solid #ccc; font-size:16px; }
button { width:100%; padding:10px; background:#ff6b6b; color:white; border:none; border-radius:8px; font-size:16px; cursor:pointer; transition:0.3s; }
button:hover { background:#ff4757; }
.message { margin-top:15px; font-weight:bold; color:#333; min-height:20px;}
</style>
</head>
<body>

<div class="container">
  <h2>Student Verification</h2>
  <form id="verifyForm">
    <input type="text" id="name" placeholder="Your Name" required>
    <input type="text" id="id" placeholder="College ID / Reg. Number" required>
    <input type="text" id="number" placeholder="WhatsApp Number" required>
    <button type="submit">Verify & Join</button>
  </form>
  <div class="message" id="msg"></div>
</div>

<script>
document.getElementById('verifyForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const name=document.getElementById('name').value.trim();
  const id=document.getElementById('id').value.trim();
  const number=document.getElementById('number').value.trim();
  const msg=document.getElementById('msg');

  msg.style.color="#333"; msg.textContent="Processing...";

  try {
    const res = await fetch('https://script.google.com/macros/s/AKfycbytdN-WXt0w7IMd4RlguDmSGMzi0iYJxp6eK6zSppk4HU07oT7LAulmJum-rIm2U2s8hQ/exec',{
      method:'POST',
      body: JSON.stringify({name,id,number}),
      headers:{'Content-Type':'application/json'}
    });

    const text=await res.text();
    let data;
    try { data = JSON.parse(text); }
    catch(err){ throw new Error("Invalid JSON response"); }

    if(data.valid){
      msg.style.color="green";
      msg.textContent = data.message || "Verification successful!";
      setTimeout(()=>{ window.location.href = data.redirectURL; },1200);
    } else {
      msg.style.color="red";
      msg.textContent = data.message || "Invalid Name/ID!";
    }

  } catch(err){
    msg.style.color="red";
    msg.textContent="Cannot connect to server!";
    console.error("Fetch error:",err);
  }
});
</script>

</body>
</html>
